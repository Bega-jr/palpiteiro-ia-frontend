<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Palpiteiro IA - Lotofácil</title>
    <style>
        body { font-family: Arial, sans-serif; text-align: center; }
        .palpite { margin: 10px; padding: 10px; border: 1px solid #ccc; }
        .premium { background-color: #ffd700; padding: 10px; }
        #login { margin: 20px; }
    </style>
    <script src="https://www.gstatic.com/firebasejs/9.6.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.0/firebase-auth.js"></script>
</head>
<body>
    <h1>Palpiteiro IA - Lotofácil</h1>
    <div id="login">
        <button id="loginButton">Entrar com Google</button>
        <p id="userInfo"></p>
    </div>
    <button onclick="gerarPalpites()">Gerar Palpites Grátis</button>
    <button onclick="alert('Modo Grok (Premium) estará disponível em breve!')" class="premium">Modo Grok (Premium)</button>
    <div id="palpites"></div>
    <h2>Histórico de Sorteios</h2>
    <div id="historico"></div>
    <h2>Taxas de Acerto (após login)</h2>
    <div id="taxas"></div>

    <script>
        // Configurar Firebase
        const firebaseConfig = {
            apiKey: "SUA_API_KEY",
            authDomain: "SEU_PROJETO.firebaseapp.com",
            projectId: "SEU_PROJETO",
            storageBucket: "SEU_PROJETO.appspot.com",
            messagingSenderId: "SEU_SENDER_ID",
            appId: "SUA_APP_ID"
        };
        firebase.initializeApp(firebaseConfig);

        const auth = firebase.auth();
        const loginButton = document.getElementById('loginButton');
        const userInfo = document.getElementById('userInfo');

        auth.onAuthStateChanged(user => {
            if (user) {
                loginButton.style.display = 'none';
                userInfo.textContent = `Bem-vindo, ${user.displayName}!`;
                carregarTaxasAcerto();
            } else {
                loginButton.style.display = 'block';
                userInfo.textContent = '';
                document.getElementById('taxas').textContent = 'Faça login para ver as taxas de acerto.';
            }
        });

        loginButton.addEventListener('click', () => {
            const provider = new firebase.auth.GoogleAuthProvider();
            auth.signInWithPopup(provider);
        });

        async function gerarPalpites() {
            try {
                const response = await fetch('https://palpiteiro-ia-backend-docker.onrender.com/gerar_palpites');
                const data = await response.json();
                const palpitesDiv = document.getElementById('palpites');
                palpitesDiv.innerHTML = '';
                data.palpites.forEach((palpite, index) => {
                    const p = document.createElement('div');
                    p.className = 'palpite';
                    p.textContent = `Aposta ${index + 1}: ${palpite.join(', ')}`;
                    palpitesDiv.appendChild(p);
                });
            } catch (error) {
                console.error('Erro ao gerar palpites:', error);
                document.getElementById('palpites').textContent = 'Erro ao gerar palpites.';
            }
        }

        async function carregarHistorico() {
            try {
                const response = await fetch('https://palpiteiro-ia-backend-docker.onrender.com/historico');
                const data = await response.json();
                const historicoDiv = document.getElementById('historico');
                historicoDiv.innerHTML = '';
                data.sorteios.forEach(sorteio => {
                    const p = document.createElement('div');
                    p.textContent = `Concurso ${sorteio.concurso} (${sorteio.data}): ${sorteio.numeros.join(', ')}`;
                    historicoDiv.appendChild(p);
                });
            } catch (error) {
                console.error('Erro ao carregar histórico:', error);
                document.getElementById('historico').textContent = 'Erro ao carregar histórico.';
            }
        }

        async function carregarTaxasAcerto() {
            try {
                const user = auth.currentUser;
                if (!user) throw new Error('Usuário não logado');
                const token = await user.getIdToken();
                const response = await fetch('https://palpiteiro-ia-backend-docker.onrender.com/taxas_acerto', {
                    headers: { 'Authorization': `Bearer ${token}` }
                });
                const data = await response.json();
                if (data.erro) throw new Error(data.erro);
                const taxasDiv = document.getElementById('taxas');
                taxasDiv.innerHTML = `Bem-vindo, ${data.user_name}! Taxas de Acerto:<br>11 números: ${data.taxas.acertos_11}<br>12 números: ${data.taxas.acertos_12}`;
            } catch (error) {
                console.error('Erro ao carregar taxas:', error);
                document.getElementById('taxas').textContent = 'Erro ao carregar taxas de acerto.';
            }
        }

        // Carregar histórico ao iniciar
        carregarHistorico();
    </script>
</body>
</html>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
